<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Building in Public | Mikeishiring</title>
  <meta name="description" content="A lightweight accountability tracker for daily progress." />
  <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="feed.xml" />
  <style>
    :root { --bg: #0a0a0a; --bg-panel: #111; --text: #e0e0e0; --text-muted: #666; --accent: #ff4500; --border: #222; --block-inactive: #1a1a1a; --block-active: #ff4500; }
    html.light { --bg: #f5f5f5; --bg-panel: #fff; --text: #1a1a1a; --text-muted: #888; --accent: #e63e00; --border: #ddd; --block-inactive: #e0e0e0; --block-active: #e63e00; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Courier New', Courier, monospace; background: var(--bg); color: var(--text); min-height: 100vh; min-height: 100dvh; overflow-x: hidden; }
    .layout { display: flex; flex-direction: column; min-height: 100vh; min-height: 100dvh; }
    .header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid var(--border); background: var(--bg-panel); }
    .brand { display: flex; align-items: center; gap: 8px; }
    .brand-logo { width: 28px; height: 28px; background: var(--accent); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; color: #000; }
    .brand-name { font-size: 12px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; color: var(--text); }
    .brand-sub { font-size: 10px; color: var(--text-muted); margin-left: 8px; }
    .header-actions { display: flex; align-items: center; gap: 12px; }
    .social-icons { display: flex; gap: 8px; }
    .social-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; border: 1px solid var(--border); color: var(--text-muted); text-decoration: none; transition: all 0.15s ease; }
    .social-icon:hover { background: var(--accent); border-color: var(--accent); color: #000; text-decoration: none; }
    .social-icon svg { width: 16px; height: 16px; fill: currentColor; }
    .theme-toggle { width: 32px; height: 32px; border-radius: 4px; border: 1px solid var(--border); background: transparent; color: var(--text-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; transition: all 0.15s ease; }
    .theme-toggle:hover { background: var(--accent); border-color: var(--accent); color: #000; }
    .content-viewer { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px 16px; overflow-y: auto; }
    .day-header { text-align: center; margin-bottom: 20px; }
    .day-number { font-size: 36px; font-weight: 700; color: var(--accent); display: block; letter-spacing: 3px; }
    .day-date { font-size: 12px; color: var(--text-muted); letter-spacing: 2px; margin-top: 4px; display: block; }
    .entries-container { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 12px; }
    .entry { background: var(--bg-panel); border-radius: 4px; padding: 16px; border-left: 3px solid var(--accent); }
    @keyframes entry-fade-in { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .entry.animate { animation: entry-fade-in 0.3s ease-out forwards; }
    .entry .tag-title { font-size: 10px; font-weight: 700; color: var(--accent); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
    .entry .text { font-size: 14px; line-height: 1.6; color: var(--text); }
    .entry-images { margin-top: 12px; display: flex; flex-wrap: wrap; gap: 8px; }
    .entry-images img { max-width: 100%; border-radius: 4px; border: 1px solid var(--border); }
    .entry-images.multiple img { max-width: calc(50% - 4px); }
    .no-entries { text-align: center; color: var(--text-muted); font-size: 12px; padding: 40px 20px; }
    .timeline-strip { height: 80px; background: var(--bg-panel); border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: center; gap: 6px; padding: 0 12px; user-select: none; flex-shrink: 0; }
    .nav-arrow { width: 36px; height: 36px; background: transparent; border: 1px solid var(--border); border-radius: 4px; color: var(--text-muted); font-size: 14px; cursor: pointer; transition: all 0.15s ease; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
    .nav-arrow:hover, .nav-arrow:active { background: var(--accent); border-color: var(--accent); color: #000; }
    .strip-container { display: flex; gap: 4px; overflow: hidden; padding: 4px 0; flex: 1; justify-content: center; }
    .strip-day { width: 36px; height: 48px; background: var(--block-inactive); border-radius: 3px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: all 0.15s ease; flex-shrink: 0; position: relative; }
    .strip-day:hover { background: #333; }
    html.light .strip-day:hover { background: #ccc; }
    .strip-day.active { background: var(--accent); }
    .strip-day.active .strip-day-num, .strip-day.active .strip-day-label { color: #000; }
    .strip-day.selected { transform: scale(1.12); z-index: 10; box-shadow: 0 0 12px var(--accent); }
    .strip-day-num { font-size: 14px; font-weight: 700; color: var(--text); line-height: 1; }
    .strip-day-label { font-size: 7px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px; }
    .year-minimap { height: 56px; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 8px 16px; cursor: crosshair; flex-shrink: 0; }
    .minimap-months { display: flex; justify-content: space-between; width: 100%; max-width: 730px; font-size: 6px; color: var(--text-muted); margin-bottom: 4px; letter-spacing: 0.5px; }
    .minimap-grid { display: flex; gap: 1px; width: 100%; max-width: 730px; }
    .minimap-day { flex: 1; height: 12px; background: var(--block-inactive); cursor: pointer; transition: background 0.1s ease; min-width: 1px; }
    .minimap-day:hover { background: #444; }
    html.light .minimap-day:hover { background: #bbb; }
    .minimap-day.active { background: var(--accent); }
    .minimap-day.selected { background: #fff; box-shadow: 0 0 4px #fff; }
    html.light .minimap-day.selected { background: #000; box-shadow: 0 0 4px #000; }
    @media (min-width: 640px) {
      .header { padding: 16px 24px; }
      .brand-logo { width: 32px; height: 32px; font-size: 16px; }
      .brand-name { font-size: 14px; letter-spacing: 3px; }
      .content-viewer { padding: 32px 24px; }
      .day-number { font-size: 48px; letter-spacing: 4px; }
      .day-date { font-size: 14px; }
      .entries-container { gap: 16px; }
      .entry { padding: 24px; }
      .entry .tag-title { font-size: 11px; margin-bottom: 10px; }
      .entry .text { font-size: 16px; line-height: 1.7; }
      .timeline-strip { height: 100px; gap: 8px; padding: 0 24px; }
      .nav-arrow { width: 40px; height: 40px; font-size: 16px; }
      .strip-container { gap: 6px; }
      .strip-day { width: 48px; height: 60px; border-radius: 4px; }
      .strip-day-num { font-size: 18px; }
      .strip-day-label { font-size: 8px; }
      .year-minimap { height: 70px; padding: 12px 24px; }
      .minimap-months { font-size: 8px; }
      .minimap-day { height: 16px; }
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
</style>
</head>
<body>
  <div class="layout">
    <header class="header">
      <div class="brand">
        <div class="brand-logo">P</div>
        <span class="brand-name">Building in Public</span>
        <span class="brand-sub">by Mikeishiring</span>
      </div>
      <div class="header-actions">
        <div class="social-icons">
          <a href="https://twitter.com/mikeishiring" target="_blank" rel="noopener" class="social-icon" aria-label="Twitter">
            <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
          <a href="https://github.com/mikeishiring" target="_blank" rel="noopener" class="social-icon" aria-label="GitHub">
            <svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        </div>
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">‚òÄÔ∏è</button>
      </div>
    </header>
    <main class="content-viewer" id="contentViewer">
      <div class="day-header">
        <span class="day-number" id="dayNumber">DAY 001</span>
        <span class="day-date" id="dayDate">2026-01-01</span>
      </div>
      <div class="entries-container" id="entriesContainer"></div>
    </main>
    <nav class="timeline-strip" id="timelineStrip">
      <button class="nav-arrow" id="navPrev" aria-label="Previous day">‚óÑ</button>
      <div class="strip-container" id="stripContainer"></div>
      <button class="nav-arrow" id="navNext" aria-label="Next day">‚ñ∫</button>
    </nav>
    <footer class="year-minimap" id="yearMinimap">
      <div class="minimap-months">
        <span>JAN</span><span>FEB</span><span>MAR</span><span>APR</span><span>MAY</span><span>JUN</span>
        <span>JUL</span><span>AUG</span><span>SEP</span><span>OCT</span><span>NOV</span><span>DEC</span>
      </div>
      <div class="minimap-grid" id="minimapGrid"></div>
    </footer>
  </div>
  <script>
    fetch('activity.json')
      .then(r => r.json())
      .then(data => {
        const dayData = {};
        data.days.forEach(d => {
          const date = new Date(d.date);
          const dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
          dayData[dayOfYear] = { date: d.date, entries: d.entries || [{ category: 'Entry', text: d.count + ' entries', tags: [], images: [] }] };
        });
        initTimeline(dayData);
      })
      .catch(err => { console.error('Failed to load:', err); initTimeline({}); });

    function initTimeline(dayData) {
      const year = new Date().getFullYear();
      const daysInYear = 365;
      const today = new Date();
      const todayDayOfYear = Math.floor((today - new Date(year, 0, 0)) / (1000 * 60 * 60 * 24));
      let selectedDayNum = todayDayOfYear > 0 ? todayDayOfYear : 1;
      const VISIBLE_DAYS = window.innerWidth < 640 ? 4 : 7;
      const dayNumberEl = document.getElementById('dayNumber');
      const dayDateEl = document.getElementById('dayDate');
      const entriesContainer = document.getElementById('entriesContainer');
      const stripContainer = document.getElementById('stripContainer');
      const minimapGrid = document.getElementById('minimapGrid');

      function renderContent() {
        const dayNum = selectedDayNum;
        const dayDate = new Date(year, 0, dayNum);
        const dateStr = dayDate.toISOString().split('T')[0];
        dayNumberEl.textContent = 'DAY ' + String(dayNum).padStart(3, '0');
        dayDateEl.textContent = dateStr;
        const data = dayData[dayNum];
        if (!data || !data.entries || data.entries.length === 0) {
          entriesContainer.innerHTML = '<div class="no-entries">// No entries logged for this day</div>';
          return;
        }
        let html = '';
        data.entries.forEach((e, i) => {
          const publicTag = (e.tags && e.tags.find(t => t.toLowerCase() === 'public')) || (e.category || '');
          let imagesHtml = '';
          if (e.images && e.images.length > 0) {
            const imgClass = e.images.length === 1 ? 'single' : 'multiple';
            imagesHtml = '<div class="entry-images ' + imgClass + '">' + e.images.map(img => '<img src="day/' + dateStr + '/media/' + img + '" alt="" loading="lazy" />').join('') + '</div>';
          }
          html += '<div class="entry animate" style="animation-delay: ' + (i * 0.05) + 's">' + (publicTag ? '<div class="tag-title">#' + publicTag + '</div>' : '') + '<div class="text">' + (e.text || '') + '</div>' + imagesHtml + '</div>';
        });
        entriesContainer.innerHTML = html;
      }

      function renderStrip() {
        stripContainer.innerHTML = '';
        const startDay = Math.max(1, selectedDayNum - VISIBLE_DAYS);
        const endDay = Math.min(daysInYear, selectedDayNum + VISIBLE_DAYS);
        for (let d = startDay; d <= endDay; d++) {
          const dayDate = new Date(year, 0, d);
          const monthName = dayDate.toLocaleString('en', { month: 'short' }).toUpperCase();
          const dayOfMonth = dayDate.getDate();
          const hasEntries = dayData[d] !== undefined;
          const block = document.createElement('div');
          block.className = 'strip-day' + (hasEntries ? ' active' : '') + (d === selectedDayNum ? ' selected' : '');
          block.dataset.day = d;
          block.innerHTML = '<span class="strip-day-num">' + dayOfMonth + '</span><span class="strip-day-label">' + monthName + '</span>';
          block.addEventListener('click', () => selectDay(d));
          stripContainer.appendChild(block);
        }
      }

      function renderMinimap() {
        minimapGrid.innerHTML = '';
        for (let d = 1; d <= daysInYear; d++) {
          const hasEntries = dayData[d] !== undefined;
          const block = document.createElement('div');
          block.className = 'minimap-day' + (hasEntries ? ' active' : '') + (d === selectedDayNum ? ' selected' : '');
          block.dataset.day = d;
          block.addEventListener('click', () => selectDay(d));
          minimapGrid.appendChild(block);
        }
      }

      function updateMinimap() {
        document.querySelectorAll('.minimap-day').forEach(block => {
          block.classList.toggle('selected', parseInt(block.dataset.day) === selectedDayNum);
        });
      }

      function selectDay(dayNum) {
        selectedDayNum = dayNum;
        renderContent();
        renderStrip();
        updateMinimap();
      }

      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') { e.preventDefault(); selectDay(Math.max(1, selectedDayNum - 1)); }
        else if (e.key === 'ArrowRight') { e.preventDefault(); selectDay(Math.min(daysInYear, selectedDayNum + 1)); }
      });

      document.getElementById('navPrev').addEventListener('click', () => selectDay(Math.max(1, selectedDayNum - 1)));
      document.getElementById('navNext').addEventListener('click', () => selectDay(Math.min(daysInYear, selectedDayNum + 1)));

      let touchStartX = 0;
      document.addEventListener('touchstart', (e) => { touchStartX = e.touches[0].clientX; }, { passive: true });
      document.addEventListener('touchend', (e) => {
        const diff = touchStartX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 50) { if (diff > 0) selectDay(Math.min(daysInYear, selectedDayNum + 1)); else selectDay(Math.max(1, selectedDayNum - 1)); }
      }, { passive: true });

      const themeToggle = document.getElementById('themeToggle');
      const html = document.documentElement;
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) { html.classList.add(savedTheme); themeToggle.textContent = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è'; }
      themeToggle.addEventListener('click', () => {
        const isLight = html.classList.contains('light');
        html.classList.remove('light', 'dark');
        html.classList.add(isLight ? 'dark' : 'light');
        themeToggle.textContent = isLight ? '‚òÄÔ∏è' : 'üåô';
        localStorage.setItem('theme', isLight ? 'dark' : 'light');
      });

      renderContent();
      renderStrip();
      renderMinimap();
    }
</script>
</body>
</html>
